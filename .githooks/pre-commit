#!/usr/bin/env bash
set -euo pipefail

# Ensure uv is available (fast no-op if already installed)
if ! command -v uv >/dev/null 2>&1; then
  # Install uv to ~/.local/bin (Linux/macOS) without prompting
  curl -LsSf https://astral.sh/uv/install.sh | sh >/dev/null 2>&1 || {
    echo "uv not found and auto-install failed. Aborting commit." >&2
    exit 1
  }
  # Make sure $HOME/.local/bin is on PATH for this shell
  export PATH="$HOME/.local/bin:$PATH"
fi

# Run pre-commit using uvx so it uses your dev deps (pre-commit, ruff, etc.)
exec uvx pre-commit run --hook-stage pre-commit "$@"
